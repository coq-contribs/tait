<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf8"><link rel="stylesheet" href="style.css" type="text/css"><title>Typing</title>
</head>

<body>

<h1>Library Typing</h1>

<code>
<code class="keyword">Require</code> <code class="keyword">Export</code> <a href="Subst2.html">Subst2</a>. <br/>

<br/>
</code>

<table width="100%"><tr class="doc"><td>
Lists for coding typing contexts. First comes the type of <code>Var 0</code> 
</td></tr></table>
<code>

<br/>
<code class="keyword">Definition</code> <a name="context"></a>context := <a href="http://coq.inria.fr/library/Coq.Lists.List.html#list">list</a> <a href="Term.html#type">type</a>.<br/>

<br/>
</code>

<table width="100%"><tr class="doc"><td>
<a name="lab1"></a><h3>Typing judgment.</h3>

</td></tr></table>
<code>

<br/>
</code>

<table width="100%"><tr class="doc"><td>
An unsafe typing function : 
</td></tr></table>
<code>

<br/>
<code class="keyword">Fixpoint</code> <a name="typ"></a>typ (ρs: context)(r:term) {struct r} : type := <br/>
&nbsp;&nbsp;match r with <br/>
&nbsp;&nbsp;&nbsp;| [n] =&gt; nth n ρs dtype<br/>
&nbsp;&nbsp;&nbsp;| r;s =&gt; arrow_right (typ ρs r)<br/>
&nbsp;&nbsp;&nbsp;| λρ,r =&gt; ρ --&gt; typ (ρ::ρs) r<br/>
&nbsp;&nbsp;end.<br/>

<br/>
</code>

<table width="100%"><tr class="doc"><td>
A predicate checking whether the output of the previous typ is ok 
</td></tr></table>
<code>

<br/>
<code class="keyword">Inductive</code> <a name="CorTyp"></a>CorTyp : context -&gt; term -&gt; Prop := <br/>
&nbsp;&nbsp;| <a name="CorVar"></a>CorVar : forall ρs n, n &lt; length ρs -&gt; CorTyp ρs [n]<br/>
&nbsp;&nbsp;| <a name="CorApp"></a>CorApp : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;forall ρs r s, CorTyp ρs r -&gt; CorTyp ρs s -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;forall σ, typ ρs r = ((typ ρs s) --&gt; σ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CorTyp ρs (r;s) <br/>
&nbsp;&nbsp;| <a name="CorAbs"></a>CorAbs : forall ρs ρ r, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CorTyp (ρ::ρs) r -&gt; CorTyp ρs (λρ,r).<br/>
<code class="keyword">Hint</code> Constructors CorTyp.<br/>

<br/>
<code class="keyword">Definition</code> <a name="TypJ"></a>TypJ (ρs:context)(r:term)(ρ:type) := <br/>
&nbsp;&nbsp;(CorTyp ρs r) /\ (typ ρs r = ρ).<br/>

<br/>
<code class="keyword">Hint</code> Unfold TypJ.<br/>

<br/>
</code>

<table width="100%"><tr class="doc"><td>
Facts about TypJ 
</td></tr></table>
<code>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_Abs"></a>TypJ_Abs : forall ρs ρ σ μ r, <br/>
&nbsp;&nbsp;σ = ρ --&gt; μ -&gt; <br/>
&nbsp;&nbsp;TypJ (ρ::ρs) r μ -&gt; TypJ ρs (λρ,r) σ.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_App"></a>TypJ_App : forall ρs ρ σ r s, <br/>
&nbsp;TypJ ρs r (ρ--&gt;σ) -&gt; TypJ ρs s ρ -&gt; TypJ ρs (r;s) σ.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_App_inv1"></a>TypJ_App_inv1 : forall ρs ρ σ r s, <br/>
&nbsp;TypJ ρs (r;s) ρ -&gt; σ = typ ρs s -&gt;<br/>
&nbsp;TypJ ρs r (σ--&gt;ρ).<br/>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_App_inv2"></a>TypJ_App_inv2 : forall ρs ρ σ r s, <br/>
&nbsp;TypJ ρs (r;s) ρ -&gt; σ = typ ρs s -&gt; TypJ ρs s σ.<br/>
<code class="keyword">Hint</code> Resolve TypJ_App TypJ_App_inv1 TypJ_App_inv2.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_ext_ctx"></a>TypJ_ext_ctx : forall r ρs σs ρ, <br/>
&nbsp;&nbsp;TypJ ρs r ρ -&gt; TypJ (ρs++σs) r ρ.<br/>
<code class="keyword">Hint</code> Resolve TypJ_ext_ctx.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_red_ctx"></a>TypJ_red_ctx : forall r ρs σs ρ, <br/>
&nbsp;&nbsp;above (length ρs) r -&gt;  <br/>
&nbsp;&nbsp;TypJ (ρs++σs) r ρ -&gt; TypJ ρs r ρ.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_up"></a>TypJ_up : forall r σs ρs ρ σ k, <br/>
&nbsp;&nbsp;length σs = k -&gt; <br/>
&nbsp;&nbsp;TypJ (σs++ρs) r ρ -&gt; <br/>
&nbsp;&nbsp;TypJ (σs++σ::ρs) (up k r) ρ.<br/>

<br/>
</code>

<table width="100%"><tr class="doc"><td>
Extension of context up to variable k 
</td></tr></table>
<code>

<br/>
<code class="keyword">Definition</code> <a name="ext_ctx"></a>ext_ctx (ρs:context)(k:nat)(ρ:type) := <br/>
&nbsp;consn (S k - length ρs) ρ nil.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="ext_ctx_length"></a>ext_ctx_length : forall ρs k ρ, length ρs &lt;= k -&gt; <br/>
&nbsp;length (ρs ++ ext_ctx ρs k ρ) = S k.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="ext_ctx_TypJ"></a>ext_ctx_TypJ : forall ρs k ρ, length ρs &lt;= k -&gt; <br/>
&nbsp;TypJ (ρs ++ ext_ctx ρs k ρ) k ρ.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="ext_ctx_last"></a>ext_ctx_last : forall ρs k ρ, length ρs &lt;= k -&gt; <br/>
&nbsp;&nbsp;last (ext_ctx ρs k ρ) dtype = ρ.<br/>

<br/>
</code>

<table width="100%"><tr class="doc"><td>
Typing substitutions. 
</td></tr></table>
<code>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_sub1"></a>TypJ_sub1 : forall r ρs σs μs ρ (rs:substitution), <br/>
&nbsp;&nbsp;length ρs = length rs -&gt; <br/>
&nbsp;&nbsp;length μs = rs.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="SubRed"></a>SubRed : forall ρs ρ σ r s, <br/>
&nbsp;TypJ ρs ((\σ,r);s) ρ -&gt;<br/>
&nbsp;TypJ ρs (sub r s) ρ.<br/>

<br/>
<code class="keyword">Lemma</code> <a name="TypJ_sub2"></a>TypJ_sub2 : forall r σs ρs ρ (rs:substitution),<br/>
&nbsp;length ρs &lt;= length rs -&gt; <br/>
&nbsp;TypJ ρs r ρ -&gt; <br/>
&nbsp;(forall n d d', n&lt;length ρs -&gt;  <br/>
&nbsp;&nbsp;&nbsp;TypJ σs (nth n rs d) (nth n ρs d')) -&gt;  <br/>
&nbsp;TypJ σs (sub r rs) ρ.<br/>
</code>
<hr/><a href="index.html">Index</a><hr/><font size="-1">This page has been generated by <a href="http://www.lri.fr/~filliatr/coqdoc/">coqdoc</a></font>
</body>
</html>